<html>
<head>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">
    <link rel="stylesheet" type="text/css" href="main.css">
</head>
<body>
    <div id="container">
      <div id="editor">
        <textarea id="input" autofocus="true"></textarea>
      </div>
      <div id="output"></div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/rxjs/5.0.1/Rx.min.js" ></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/1.6.4/showdown.min.js"></script>
    <script>
        function placeCaretAtEnd(element) {
            element.focus();

            if (typeof window.getSelection != "undefined"
                    && typeof document.createRange != "undefined") {

                var range = document.createRange();
                range.selectNodeContents(element);
                range.collapse(false);

                var selection = window.getSelection();
                selection.removeAllRanges();
                selection.addRange(range);

            } else if (typeof document.body.createTextRange != "undefined") {

                var textRange = document.body.createTextRange();
                textRange.moveToElementText(element);
                textRange.collapse(false);
                textRange.select();
            }
        }

        var converter = new showdown.Converter();
        showdown.setFlavor('github');

        var inputArea = document.getElementById('input');

        var keyupStream =
            Rx.Observable.fromEvent(inputArea, 'keyup')
                .debounceTime(0);

        var contentStream = keyupStream.map(function() {
            return inputArea.value;
        });

        contentStream.subscribe(function(content)  {
            outputArea = document.getElementById('output')

            if (content.length > 0) {
			    outputArea.innerHTML = converter.makeHtml(content);
            } else {
                outputArea.innerHTML = '';
            }
        });
    </script>
</body>
</html>

